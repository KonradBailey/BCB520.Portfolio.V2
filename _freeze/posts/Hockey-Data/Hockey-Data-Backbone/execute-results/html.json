{
  "hash": "c44c5fd6a1b181a80e98973585208243",
  "result": {
    "markdown": "---\ntitle: \"ASSIGNMENT 05\"\nsubtitle: \"Visualizations for Tabular Data\"\nauthor: \"Konrad Bailey\"\ndate: \"2024-02-25\"\ncategories: [Assignment, DataViz, Tables, Scatterplot, Barplot, Piechart]\ncode-fold: true\ncode-tools: true\ncode-link: true\ndescription: \"Should I trade these draft picks for this bag of magic beans...?\"\neval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(patchwork)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhockey.data <- read.csv(\"~/Desktop/NHLdraftstats.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhockey.data$round <- factor(hockey.data$round, \n                        levels = sort(unique(hockey.data$round)), \n                        ordered = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(hockey.data)\n```\n:::\n\n\n# Simple Scatterplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(draft2022, aes(x = round, y = NHLgames, size = Count)) +\n  geom_point(col = \"#4A7D81\", alpha = 0.6) +\n  scale_size_continuous(range = c(3, 10)) +\n  scale_y_continuous(limits = c(0, max(draft2022$NHLgames) * 1.1)) +\n  theme_minimal() +\n  labs(title = \"Number of NHL Games Played as a Function of Draft Round\",\n       x = \"Draft Round\",\n       y = \"NHL Games Played\",\n       size = \"Number of Players\",\n       caption = \"Figure 1. Relationship between which round players were drafted\\nand the number of games they played in. Key: Draft Round.\\nValue: NHL Games Played. Marks: dots. Channels: position and size of dots.\") +\n  theme(legend.position = \"bottom\",\n        plot.caption = element_text(hjust = 0))\n```\n:::\n\n\n# Expanded Scatterplot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndraft.2018<-hockey.data%>%\n  filter(draftyear==2018 & postdraft<6) \n\ndraft.tot.2018<- draft.2018%>%\n  group_by(playerId, round, overall, position, name)%>%\n  summarise(totgames=sum(NHLgames))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(draft.tot.2018, aes(x = round, y = totgames, size = count)) +\n  geom_jitter(alpha = 0.6, color = \"#4A7D81\", width = 0.2, height = 0) +  # Add jitter to the dots\n  scale_size_area(name = \"Number of Players\", max_size = 15, breaks = c(1, 5, 10, 20), labels = c(\"1\", \"5\", \"10\", \"20\")) +\n  theme_minimal() +\n  labs(title = \"Total Number of NHL Games Played as a Function of Draft Round\",\n       x = \"Draft Round\",\n       y = \"Total NHL Games Played\",\n       caption = \"Figure 1. Relationship between which round players were drafted\\nand the total number of games they played in. Key: Draft Round.\\nValue: Total NHL Games Played. Marks: dots. Channels: position \\nand size of dots.\") +\n  theme(legend.position = \"bottom\",\n        plot.caption = element_text(hjust = 0))\n```\n:::\n\n\n# SCATTERPLOT WITH OVERALL DRAFT POSITION\n\nMidnight Blue: #191970\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhockey.total <- hockey.data%>%\n  group_by(playerId, round, overall, position, name)%>%\n  summarise(totgames=sum(NHLgames))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(hockey.total, aes(x=overall, y=totgames))+\n  geom_point()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhockey.total$overall_color <- factor(ifelse(hockey.total$overall == 1, \"#191970\",\n                                      ifelse(hockey.total$overall == 2, \"#5B92E5\",\n                                      ifelse(hockey.total$overall == 3, \"#95C8D8\",\n                                             \"#C4C3D0\"))))\n\nggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Pick\",\n       x = \"Overall Draft Pick\",\n       y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"right\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhockey.total$size <- ifelse(hockey.total$overall %in% c(1, 2, 3), 2.5, 1.5)  # Increase size for 1, 2, 3\n\n# Update the ggplot code to reflect the new size adjustments\nggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(aes(size = I(size)), alpha = 0.6) +  # Use I(size) to apply the size directly\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Pick\",\n       x = \"Overall Draft Pick\",\n       y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1)),\n         size = FALSE) +  # Hide the size legend\n  theme(legend.position = \"right\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhockey.total$size <- ifelse(hockey.total$overall %in% c(1, 2, 3), 2.5, 1)  # Increase size for 1, 2, 3; decrease for others\n\n# Update the ggplot code to include the adjusted size aesthetic\n# and limit the x-axis to show only overall scores less than 12\nggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color, size = I(size))) +\n  geom_point(alpha = 0.6) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Pick\",\n       x = \"Overall Draft Pick\",\n       y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1)),\n         size = FALSE) +  # Hide the size legend since it's manually set\n  theme(legend.position = \"right\") +\n  coord_cartesian(xlim = c(NA, 11)) # Limit the x-axis to overall scores less than 12\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +  # Jitter dots with specified size\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Pick\",\n       x = \"Overall Draft Pick\",\n       y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"right\") +\n  coord_cartesian(xlim = c(NA, 6)) # Limit the x-axis to show only overall scores less than 7\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 2.5) +  # Fixed size for all dots\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"right\")\n\n# Second plot (with jitter)\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +  # Jittered dots\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) # Limit x-axis\n\ncombined_plot <- (plot1 | plot2) + \n  plot_annotation(title = \"Total NHL Games Played by Draft Pick\", \n                  theme = theme(plot.title = element_text(hjust = 0.5))) +\n  plot_layout(guides = 'collect')\n\n# Move the shared legend to the bottom\ncombined_plot <- combined_plot & theme(legend.position = \"bottom\")\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 2.5) +  # Specific size for all dots\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\")  # Hide legend here, will be shown on combined plot\n\n# Second plot with jittered dots and specific sizes as per your updated requirements\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +  # Use jitter with specified size\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +  # Limit x-axis as per your requirement\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\")  # Hide legend here as well\n\n# Combine the plots side by side with a shared title and a single legend at the bottom\ncombined_plot <- plot1 + plot2 + \n  plot_layout(guides = 'collect') +\n  plot_annotation(title = \"Total NHL Games Played by Draft Pick\", theme = theme(plot.title = element_text(hjust = 0.5)))\n\n# Adjust the legend position to the bottom for the combined plot\ncombined_plot <- combined_plot & theme(legend.position = \"bottom\")\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the first plot\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Pick\",\n       x = \"Overall Draft Pick\",\n       y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"right\")\n\n# Define the second plot\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +  # Jitter dots with specified size\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(title = \"Total NHL Games Played by Draft Pick\",\n       x = \"Overall Draft Pick\",\n       y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"right\") +\n  coord_cartesian(xlim = c(NA, 6)) # Limit the x-axis to show only overall scores less than 7\n\n# Combine the plots side-by-side without altering titles or legends\ncombined_plot <- plot1 + plot2\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 1.5) +  # Reduced specific size for all dots to 1.5\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\")  # Hide legend here, will be shown on combined plot\n\n# Second plot remains unchanged\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +  # Use jitter with specified size\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +  # Limit x-axis as per your requirement\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\")  # Hide legend here as well\n\n# Combine the plots side by side with a shared title and a single legend at the bottom\ncombined_plot <- plot1 + plot2 + \n  plot_layout(guides = 'collect') +\n  plot_annotation(title = \"Total NHL Games Played as a Function Draft Pick\", theme = theme(plot.title = element_text(hjust = 0.5)))\n\n# Adjust the legend position to the bottom for the combined plot\ncombined_plot <- combined_plot & theme(legend.position = \"bottom\")\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 1.5) +  # Adjusted size for smaller dots\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\", \n        axis.title.x = element_text(size = 10),  # Smaller font size for x-axis label\n        axis.title.y = element_text(size = 10))  # Smaller font size for y-axis label\n\n# Define the second plot without the y-axis label and with jittered dots\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +\n  labs(x = \"Overall Draft Pick\", y = NULL) +  # Removed y-axis label\n  guides(color = guide_legend(title = \"Overall Score Color\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\", \n        axis.title.x = element_text(size = 10))  # Smaller font size for x-axis label, y-axis label is not shown\n\n# Combine the plots side by side with a shared title and a single legend at the bottom\ncombined_plot <- plot1 + plot2 + \n  plot_layout(guides = 'collect') +\n  plot_annotation(title = \"Total NHL Games Played as a Function Draft Pick\", \n                  theme = theme(plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\")))\n\n# Adjust the legend position to the bottom for the combined plot\ncombined_plot <- combined_plot & theme(legend.position = \"bottom\")\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 1.2) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\"),\n                     labels = c(\"Draft Pick 1\", \"Draft Pick 2\", \"Draft Pick 3\", \"Draft Pick > 3\"),\n                     breaks = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  guides(color = guide_legend(title = \"Draft Pick Value\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\")\n\n# Define the second plot with customized legend labels and without the y-axis label\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\"),\n                     labels = c(\"Draft Pick 1\", \"Draft Pick 2\", \"Draft Pick 3\", \"Draft Pick > 3\"),\n                     breaks = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +\n  labs(x = \"Overall Draft Pick\", y = NULL) +\n  guides(color = guide_legend(title = \"Draft Pick Value\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\")\n\n# Combine the plots side by side with the legend placed at the bottom\ncombined_plot <- plot1 + plot2 + \n  plot_layout(guides = 'collect') +\n  plot_annotation(title = \"Total NHL Games Played as a Function Draft Pick\", \n                  theme = theme(plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\", margin = margin(b = 10))))\n\n# Adjust the legend position to the bottom for the combined plot\ncombined_plot <- combined_plot & theme(legend.position = \"bottom\")\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 1.5) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  theme(legend.position = \"none\")\n\n# Define plot2 with a legend and specify the size of the dots in the legend.\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\"),\n                     labels = c(\"Draft Pick 1\", \"Draft Pick 2\", \"Draft Pick 3\", \"Draft Pick > 3\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +\n  labs(x = \"Overall Draft Pick\", y = NULL) +\n  guides(color = guide_legend(title = \"Overall Draft Pick\",\n                              override.aes = list(size = 2.5)))  # Set the size of dots in the legend\n\n# Combine the plots side by side, ensuring only plot2's legend is used.\ncombined_plot <- plot1 + plot2\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 1.2) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\"),\n                     labels = c(\"Draft Pick 1\", \"Draft Pick 2\", \"Draft Pick 3\", \"Draft Pick > 3\"),\n                     breaks = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") #+\n  #guides(color = guide_legend(title = \"Draft Pick Value\", override.aes = list(alpha = 1))) +\n  #theme(legend.position = \"none\")\n\n# Define the second plot with customized legend labels and without the y-axis label\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\"),\n                     labels = c(\"Draft Pick 1\", \"Draft Pick 2\", \"Draft Pick 3\", \"Draft Pick > 3\"),\n                     breaks = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +\n  labs(x = \"Overall Draft Pick\", y = NULL) +\n  guides(color = guide_legend(title = \"Draft Pick Value\", override.aes = list(alpha = 1))) +\n  theme(legend.position = \"none\")\n\n# Combine the plots side by side with the legend placed at the bottom\ncombined_plot <- plot1 + plot2 + \n  plot_layout(guides = 'collect') +\n  plot_annotation(title = \"Total NHL Games Played as a Function Draft Pick\", \n                  theme = theme(plot.title = element_text(hjust = 0.5, size = 14, face = \"bold\", margin = margin(b = 10))))\n\n# Adjust the legend position to the bottom for the combined plot\ncombined_plot <- combined_plot & theme(legend.position = \"bottom\")\n\n# Display the combined plot\ncombined_plot\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 1.2) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Overall Draft Pick\", y = \"Total NHL Games Played\") +\n  theme(legend.position = \"none\")\n\n# Define plot2 with a legend and specify the size of the dots in the legend\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\"),\n                     labels = c(\"Draft Pick 1\", \"Draft Pick 2\", \"Draft Pick 3\", \"Draft Pick > 3\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +\n  labs(x = \"Overall Draft Pick\", y = NULL) +\n  guides(color = guide_legend(title = \"Overall Draft Pick\",\n                              override.aes = list(size = 2.5)))  # Set the size of dots in the legend\n\n# Combine the plots side by side, ensuring only plot2's legend is used\ncombined_plot <- plot1 + plot2\n\n# Add a single title for the whole figure and make the font bold\ncombined_plot + plot_annotation(title = \"Total NHL Games Played as a Function of Draft Pick\", \n                                theme = theme(plot.title = element_text(face = \"bold\")))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_point(alpha = 0.6, size = 1.1) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\")) +\n  theme_minimal() +\n  labs(x = \"Draft Round\", y = \"Total NHL Games Played\") +\n  theme(legend.position = \"none\")\n\n# Define plot2 with a legend and specify the size of the dots in the legend\nplot2 <- ggplot(hockey.total, aes(x = overall, y = totgames, color = overall_color)) +\n  geom_jitter(alpha = 0.6, size = 2.5, width = 0.2, height = 0) +\n  scale_color_manual(values = c(\"#191970\", \"#5B92E5\", \"#95C8D8\", \"#C4C3D0\"),\n                     labels = c(\"R1\", \"R2\", \"R3\", \"R > 3\")) +\n  theme_minimal() +\n  coord_cartesian(xlim = c(NA, 6)) +\n  labs(x = \"Draft Round\", y = NULL) +\n  guides(color = guide_legend(title = \"Draft Round:\",\n                              override.aes = list(size = 2.5)))  # Set the size of dots in the legend\n\n# Combine the plots side by side, ensuring only plot2's legend is used\ncombined_plot <- plot1 + plot2\n\n# Add a single title for the whole figure and make the font bold\n# And, shrink the size of the legend\ncombined_plot_final = combined_plot + \n  plot_annotation(title = \"Total NHL Games Played as a Function of Draft Round\", \n                  theme = theme(plot.title = element_text(face = \"bold\"))) +\n  theme(legend.position = \"bottom\",\n        legend.text = element_text(size = 8), # Smaller text in the legend\n        legend.title = element_text(size = 9), # Smaller title in the legend\n        legend.key.size = unit(0.5, \"cm\")) # Smaller keys in the legend\n\n# Display the combined plot with the adjusted legend\ncombined_plot_final\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}